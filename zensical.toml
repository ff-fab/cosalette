# Documentation site configuration (native Zensical format)
#
# Zensical is a documentation framework by the creators of Material for MkDocs.
# This file replaces mkdocs.yml with native TOML configuration.
#
# Usage (via Taskfile — single source of truth for tool commands):
#   task docs:serve       # Local preview with hot reload
#   task docs:build       # Build static site to site/
#
# Structure follows a DITA-style information typing:
#   Tasks     — action-oriented (procedures: how to do something)
#   Concepts  — understanding-oriented (what/why, mental model)
#   Reference — information-oriented (facts: parameters, schemas, APIs)

# ---------------------------------------------------------------------------
# Project
# ---------------------------------------------------------------------------

[project]
site_name = "cosalette"
site_description = "an opinionated Python framework for building IoT-to-MQTT bridge applications"

# Canonical URL for the deployed site. Used for sitemap and social cards.
# Note: zensical.toml does not support environment variable substitution.
# The CI workflow hardcodes the same URL, so this is the single source of truth.
site_url = "https://ff-fab.github.io/cosalette/"

repo_url = "https://github.com/ff-fab/cosalette"
repo_name = "ff-fab/cosalette"
edit_uri = "edit/main/docs/"

# ---------------------------------------------------------------------------
# Navigation
# ---------------------------------------------------------------------------

nav = [
    { "Home" = "index.md" },
    { "Getting Started" = [
        "getting-started/index.md",
        { "Quickstart" = "getting-started/quickstart.md" },
    ] },
    { "Concepts" = [
        "concepts/index.md",
        { "Architecture" = "concepts/architecture.md" },
        { "Device Archetypes" = "concepts/device-archetypes.md" },
        { "Hexagonal Architecture" = "concepts/hexagonal.md" },
        { "MQTT Topics" = "concepts/mqtt-topics.md" },
        { "Configuration" = "concepts/configuration.md" },
        { "Application Lifecycle" = "concepts/lifecycle.md" },
        { "Error Handling" = "concepts/error-handling.md" },
        { "Health & Availability" = "concepts/health-reporting.md" },
        { "Logging" = "concepts/logging.md" },
        { "Testing" = "concepts/testing.md" },
    ] },
    { "How-To Guides" = [
        "guides/index.md",
        { "Telemetry Device" = "guides/telemetry-device.md" },
        { "Command & Control Device" = "guides/command-device.md" },
        { "Configuration" = "guides/configuration.md" },
        { "Hardware Adapters" = "guides/adapters.md" },
        { "Lifecycle Hooks" = "guides/lifecycle-hooks.md" },
        { "Testing" = "guides/testing.md" },
        { "Custom Error Types" = "guides/error-types.md" },
        { "Build a Full App" = "guides/full-app.md" },
    ] },
    { "Reference" = [
        "reference/index.md",
        { "API Reference" = "reference/api.md" },
        { "Testing Utilities" = "reference/testing.md" },
        { "Settings" = "reference/settings.md" },
        { "MQTT Topics" = "reference/mqtt-topics.md" },
        { "CLI Options" = "reference/cli.md" },
        { "Payload Schemas" = "reference/payloads.md" },
    ] },
    { "Architecture Decisions" = "adr/index.md" },
]

# Note: exclude_docs is not yet supported in zensical.toml (see Zensical docs).
# The TODO/, demos/, and testing/ directories may appear as unlisted pages.

# ---------------------------------------------------------------------------
# Theme
# ---------------------------------------------------------------------------

[project.theme]
# "classic" preserves the Material for MkDocs look.
# Switch to "modern" (default) for Zensical's fresh new design.
variant = "classic"
features = [
    "navigation.tabs",
    "navigation.tabs.sticky",
    "navigation.sections",
    "navigation.expand",
    "navigation.indexes",
    "navigation.top",
    "search.suggest",
    "search.highlight",
    "content.code.copy",
    "content.code.annotate",
    "content.tabs.link",
    "content.action.edit",
]

[project.theme.icon]
repo = "fontawesome/brands/github"

# --- Color palette toggle (dark / light) ---

[[project.theme.palette]]
scheme = "slate"
primary = "amber"
accent = "orange"
toggle.icon = "material/brightness-4"
toggle.name = "Switch to light mode"

[[project.theme.palette]]
scheme = "default"
primary = "amber"
accent = "orange"
toggle.icon = "material/brightness-7"
toggle.name = "Switch to dark mode"

# ---------------------------------------------------------------------------
# Plugins
# ---------------------------------------------------------------------------

[project.plugins.autorefs]

[project.plugins.mkdocstrings.handlers.python]
paths = ["packages/src"]

[project.plugins.mkdocstrings.handlers.python.options]
show_source = true
show_root_heading = true
show_symbol_type_heading = true
members_order = "source"
show_signature_annotations = true
separate_signature = true
signature_crossrefs = true
merge_init_into_class = true
docstring_style = "google"

# ---------------------------------------------------------------------------
# Markdown extensions
# ---------------------------------------------------------------------------

# Admonitions (note, warning, tip, etc.)
[project.markdown_extensions.admonition]
[project.markdown_extensions.pymdownx.details]

# HTML / attribute extensions (required for grid cards, icon sizing)
[project.markdown_extensions.attr_list]
[project.markdown_extensions.md_in_html]

# Code blocks
[project.markdown_extensions.pymdownx.highlight]
anchor_linenums = true
line_spans = "__span"
pygments_lang_class = true

[project.markdown_extensions.pymdownx.inlinehilite]

[project.markdown_extensions.pymdownx.superfences]

[[project.markdown_extensions.pymdownx.superfences.custom_fences]]
name = "mermaid"
class = "mermaid"
format = "pymdownx.superfences.fence_code_format"

# Content tabs (e.g., showing Python / TypeScript side by side)
[project.markdown_extensions.pymdownx.tabbed]
alternate_style = true

# Typography and formatting
[project.markdown_extensions.pymdownx.mark]
[project.markdown_extensions.pymdownx.smartsymbols]
[project.markdown_extensions.pymdownx.keys]

# Lists and task lists
[project.markdown_extensions.def_list]
[project.markdown_extensions.pymdownx.tasklist]
custom_checkbox = true

# Table of contents
[project.markdown_extensions.toc]
permalink = true
toc_depth = 3

# Tables
[project.markdown_extensions.tables]

# Footnotes
[project.markdown_extensions.footnotes]

# Emoji (used sparingly for status indicators)
[project.markdown_extensions.pymdownx.emoji]
emoji_index = "zensical.extensions.emoji.twemoji"
emoji_generator = "zensical.extensions.emoji.to_svg"

# ---------------------------------------------------------------------------
# Extra
# ---------------------------------------------------------------------------

[[project.extra.social]]
icon = "fontawesome/brands/github"
link = "https://github.com/ff-fab/cosalette"
